!function(t,e){"function"==typeof define&&define.amd?define(["d3"],e):"object"==typeof module&&module.exports?module.exports=function(t){return t.kodama=e(t),t.kodama}:t.d3.kodama=t.d3.bamboo=e(t.d3)}(this,function(t){function e(t){return t=t.split("-").join(),p[t]}if(t.kodama)return t.kodama;var n,i,o={},a=["gravity","theme","distance","style","target","by","fadeInDuration","fadeOutDuration","holdDuration"],r=null,l=null,u=null,d=null,s="none",p={northwest:[-1,-1],topleft:[-1,-1],upperleft:[-1,-1],northeast:[1,-1],topright:[1,-1],upperright:[1,-1],southwest:[-1,1],bottomleft:[-1,1],lowerleft:[-1,1],southeast:[1,1],bottomright:[1,1],lowerright:[1,1],north:[0,-1],top:[0,-1],south:[0,1],bottom:[0,-1],west:[-1,0],left:[-1,0],right:[1,0],east:[1,0],center:[0,0]},f={},c=[0,0],h="0:0",g=null,m=!1,v=null,y=0,b=0,x=500,w="kodama",k="top",_="top",D=e(k),O=e(_),A=25,H=f[w]={frame:{padding:"4px",background:"linear-gradient(to top, rgb(16, 74, 105) 0%, rgb(14, 96, 125) 90%)","font-family":'"Helvetica Neue", Helvetica, Arial, sans-serif',border:"1px solid rgb(57, 208, 204)",color:"rgb(245,240,220)","border-radius":"4px","font-size":"12px","box-shadow":"0px 1px 3px rgba(0,20,40,.5)"},title:{"text-align":"center",padding:"4px"},item_title:{"text-align":"right",color:"rgb(220,200,120)"},item_value:{padding:"1px 2px 1px 10px",color:"rgb(234, 224, 184)"}};o.init=function(e){r=e||document.body,l&&l.remove(),l=t.select(r).append("div").style("position","absolute").style("left",0).style("top",0).style("visibility","hidden").style("pointer-events","none").attr("class","kodama-tooltip").attr("name","kodama"),u=l.append("div").attr("name","kodamaTip").style({position:"relative","pointer-events":"none","z-index":9999}).style("opacity",0),d=u.append("div").style("position","relative")},"loading"===document.readyState?document.addEventListener("DOMContentLoaded",function(){o.init()}):o.init(),o.holdDuration=function(t){return 0===arguments.length?y:(y=t,o)},o.fadeInDuration=function(t){return 0===arguments.length?b:(b=t,o)},o.fadeOutDuration=function(t){return 0===arguments.length?x:(x=t,o)},o.distance=function(t){return 0===arguments.length?A:(A=t||25,o)},o.gravity=function(t){return 0===arguments.length?k:(k=t||"top",D=e(k),o)},o.theme=function(t){return 0===arguments.length?w:(w=t,H=f[w],o)},o.themeRegistry=function(t,e){return 1===arguments.length?f[t]:(f[t]=e,o)},o.themeRegistry("white_wolf",{frame:{padding:"5px",background:"linear-gradient(to top, rgba(220, 230, 240, .6) 0%, rgba(235, 240, 245, .9) 90%, rgba(230, 235, 240, .8) 100%)","font-family":'"Helvetica Neue", Helvetica, Arial, sans-serif',border:"1px solid rgb(220, 230, 250)","border-radius":"6px","font-size":"14px","box-shadow":"0px 1px 3px rgba(0,20,70,.5)"},title:{"text-align":"center",padding:"4px",color:"rgb(115,130,140)","font-size":"15px","text-shadow":"0 -1px 0 rgba(255,255,255,.5)"},item_title:{"text-align":"right",color:"rgb(80,100,110)","font-size":"14px","text-shadow":"0 -1px 0 rgba(255,255,255,.5)"},item_value:{padding:"1px 2px 1px 10px",color:"rgb(90, 95, 85)","font-size":"14px","text-shadow":"0 -1px 0 rgba(255,255,255,.5)"}}),o.tooltip=function(){var o={},p=void 0,w=void 0,z=void 0,I=null,M=A,j=k,Q=D,R=_,W=O,Z=H,$=y,C=b,L=x,N=v,B={},E={},P=function S(t){t.on("mouseover.tooltip",function(t,e){S.show(t,e)}).on("mousedown.tooltip",function(){S.show(null)}).on("mouseup.tooltip",function(){S.show(null)}).on("mousemove.tooltip",function(){S._update()}).on("mouseout.tooltip",function(){S.show(null)})};return P._build=function(){if(!g)return void P.fadeOut();P.activateAfter($),d.selectAll("*").remove(),d.append("div").attr(B).style(Z.frame).datum(g).each(function(e){var n=t.select(this);if(e.title&&n.append("div").style(Z.title).append("span").html(e.title),e.items){var i=n.append("table").append("tbody");i.selectAll("tr").data(e.items).enter().append("tr").each(function(e){var n=t.select(this),i=n.append("td"),o=n.append("td");i.html(e.title+":").style(Z.item_title),o.html(e.value).style(Z.item_value)})}});for(var e=d.node().clientWidth/2,n=d.node().clientHeight/2,i=-1;1>=i;i++)for(var a=-1;1>=a;a++){var r=i+":"+a;o[r]={left:i*(e+M)+"px",top:a*(n+M)+"px"}}P._update(!0)},P._update=function(e){function n(e,n){if(!e)return t.mouse(r);var i=e.getBoundingClientRect(),o=i.width/2,a=i.height/2;return[i.left+(n[0]+1)*o,i.top+(n[1]+1)*a]}if(g){for(var i=n(N,W),a=i[0],l=i[1],s=r.clientWidth,p=r.clientHeight,f=u.node().clientWidth,m=u.node().clientHeight,v=null,y=5,b=a>s-f?-1:a>s-f-2*M?0:1,x=l>p-m?-1:l>p-m-2*M?0:1,w=f>a?1:f+2*M>a?0:-1,k=m>l?1:m+2*M>l?0:-1,_=w;b>=_;_++)for(var D=k;x>=D;D++)if(0!==_||0!==D||0===Q[0]||0===Q[1]){var O=Math.abs(_-Q[0])+Math.abs(D-Q[1]);y>O&&(v=[_,D],y=O)}v=v||[0,0];var A=a-f/2,H=l-m/2;u.style({left:A+"px",top:H+"px"});var z=v[0]+":"+v[1],I=Math.max(Math.abs(c[0]-a),Math.abs(c[1]-l));if(e||z!==h&&I>M){h=z,c=i;var j=o[z];d.transition().ease("cubic-out").duration(250).style(j)}}},P.attr=function(t){return arguments.length?(B=t,this):B},P.style=P.css=function(t){return arguments.length?(E=t,this):E},P.fadeIn=function(){if("in"!==s){s="in";var t=u.style("opacity")/1,e=(1-t)*C;u.interrupt().transition().duration(e).style("opacity",1)}},P.fadeOut=function(){if("out"!==s){s="out";var t=u.style("opacity")/1,e=t*L;u.transition().delay(50).duration(e).style("opacity",0)}},P.activate=function(){m=!0,P.fadeIn()},P.deactivate=function(){n=null,m=!1,P.fadeOut()},P.activateAfter=function(){l.interrupt().transition(),m?P.fadeIn():l.transition().delay($).duration(0).each("start",P.activate).style("visibility","visible")},P.theme=function(t){return 0===arguments.length?Z:(Z=f[t],this)},P.target=function(t){if(0===arguments.length)return N;for(var e=t;e&&e.length>0;)e=e[0];return N=e,this},P.holdDuration=function(t){return 0===arguments.length?$:($=t,this)},P.fadeInDuration=function(t){return 0===arguments.length?C:(C=t,this)},P.fadeOutDuration=function(t){return 0===arguments.length?L:(L=t,this)},P.distance=function(t){return 0===arguments.length?M:(M=t,this)},P.gravity=function(t){return 0===arguments.length?Q:(j=t,Q=e(j),this)},P.by=function(t){return 0===arguments.length?W:(R=t,W=e(R),this)},P.options=function(t){if(0===arguments.length)return p;if(!t)return this;if(t.theme&&(P.theme(t.theme),Z.options))for(var e in Z.options)t.hasOwnProperty(e)||(t[e]=Z.options[e]);for(var n in t)-1!==a.indexOf(n)&&P[n](t[n]);return p=t,this},P.format=P.prep=P.data=function(t){return I=t,this},P.show=function(t,e){z=t,w=e,z===n&&I===i||(i=I,n=z,g=I&&z?I(z,w):z,P.options(g),P._build()),P._update()},P};var z="undefined"!=typeof jQuery&&null!==jQuery?jQuery:null;return z=z||("undefined"!=typeof Zepto&&null!==Zepto?Zepto:null),z&&(z.fn.kodama=$.fn.kodama_tooltip=$.fn.bamboo=$.fn.kodama||function(e){var n=this,i=n.toArray(),o=t.range(i.length).map(function(){return e});return t.selectAll(i).data(o).call(t.kodama.tooltip()),this}),o});